<!DOCTYPE html>
<html>
<head>
  <title>Ubicación</title>
</head>
<body>
  <h1>Obtener y Guardar Ubicación</h1>
  <p id="status">Esperando ubicación...</p>

  <script>
    // Verifica si el navegador soporta la geolocalización
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        function(position) {
          var lat = position.coords.latitude;
          var lng = position.coords.longitude;
          var coordinates = lat + ", " + lng;

          // Muestra el estado
          document.getElementById('status').innerText = "Ubicación obtenida: " + coordinates;

          // Llama a tu endpoint de Apps Script usando fetch
          // Reemplaza 'TU_SCRIPT_ID' por el ID de despliegue de tu web app de Apps Script
          fetch("https://script.google.com/macros/s/TU_SCRIPT_ID/exec?direccion=" + encodeURIComponent(coordinates))
            .then(response => response.text())
            .then(result => {
              document.getElementById('status').innerText += "\n" + result;
            })
            .catch(error => {
              document.getElementById('status').innerText += "\nError al guardar la ubicación.";
              console.error("Error:", error);
            });
        },
        function(error) {
          switch (error.code) {
            case error.PERMISSION_DENIED:
              document.getElementById('status').innerText = "Error: Permiso de ubicación denegado.";
              break;
            case error.POSITION_UNAVAILABLE:
              document.getElementById('status').innerText = "Error: La ubicación no está disponible.";
              break;
            case error.TIMEOUT:
              document.getElementById('status').innerText = "Error: La solicitud de geolocalización ha expirado.";
              break;
            case error.UNKNOWN_ERROR:
              document.getElementById('status').innerText = "Error: Se produjo un error desconocido.";
              break;
          }
        }
      );
    } else {
      document.getElementById('status').innerText = "Error: La geolocalización no es soportada por este navegador.";
    }
  </script>
</body>
</html>
